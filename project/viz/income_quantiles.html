<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<style type="text/css" media="screen, print">
			body { margin: 30px 50px; font-family: sans-serif; }
		</style>
		<title>US - 2014 - Income cdf</title>
	</head>
	<body>
		<h1>US - 2014 - Income cdf</h1>

		<script src="../vendor/d3/d3.js"></script>
		<script>

var margin = {top: 100, right: 100, bottom: 40, left: 100},
    width = 800 - margin.left - margin.right,
    height = 600 - margin.top - margin.bottom;

var x = d3.scaleLinear()
    .range([0, width])
    .domain([0, 1]);

var y = d3.scaleLinear()
    .range([height, 0])
    .domain([0, 1]);

var svg = d3.select('body').append('svg')
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

d3.tsv("../data/income/US.tsv", function(error, data) {
	if(error) throw error;

	data = data
		.filter(d => +d.year == 2014)
		.sort((a, b) => +a.low - +b.low);

	var data1 = data.filter(d => +d.cumul <= 0.25);	
	var data2 = data.filter(d => (+d.cumul >= 0.25) && (+d.cumul <=0.5));
	var data3 = data.filter(d => (+d.cumul >= 0.5) && (+d.cumul <=0.75));
	var data4 = data.filter(d => (+d.cumul >= 0.75));
	var g = svg.selectAll('.hist')
    		.data(data1)
		.enter().append('rect')
	    	.attr('x',      d => x(+d.low))
	    	.attr('y',      d => y(+d.cumul))
	    	.attr('width',  d => x(+d.high)-x(+d.low))
	    	.attr('height', d => y(0)-y(+d.cumul))
		.attr('fill', "rgb(255, 255, 0)");
	var g = svg.selectAll('.hist')
    		.data(data2)
		.enter().append('rect')
	    	.attr('x',      d => x(+d.low))
	    	.attr('y',      d => y(+d.cumul))
	    	.attr('width',  d => x(+d.high)-x(+d.low))
	    	.attr('height', d => y(0)-y(+d.cumul))
		.attr('fill', "rgb(255, 200, 0)");
	var g = svg.selectAll('.hist')
    		.data(data3)
		.enter().append('rect')
	    	.attr('x',      d => x(+d.low))
	    	.attr('y',      d => y(+d.cumul))
	    	.attr('width',  d => x(+d.high)-x(+d.low))
	    	.attr('height', d => y(0)-y(+d.cumul))
		.attr('fill', "rgb(255, 150, 0)");
	var g = svg.selectAll('.hist')
    		.data(data4)
		.enter().append('rect')
	    	.attr('x',      d => x(+d.low))
	    	.attr('y',      d => y(+d.cumul))
	    	.attr('width',  d => x(+d.high)-x(+d.low))
	    	.attr('height', d => y(0)-y(+d.cumul))
		.attr('fill', "rgb(255, 0, 0)");
	/*var cdf = d3.line()
		.x(function(d) { return x(+d.high); })
		.y(function(d) { return y(+d.cumul); });

	var line1 = svg.append("path").datum(data1)
		.attr("d", cdf)
		.attr("stroke", "black")
		.attr("stroke-width", 1)
		.attr("fill", "rgb(255, 255, 0)");
	var line2 = svg.append("path").datum(data2)
		.attr("d", cdf)
		.attr("stroke", "black")
		.attr("stroke-width", 1)
		.attr("fill", "rgb(255, 200, 0)");
	var line3 = svg.append("path").datum(data3)
		.attr("d", cdf)
		.attr("stroke", "black")
		.attr("stroke-width", 1)
		.attr("fill", "rgb(255, 150, 0)");
	var line4 = svg.append("path").datum(data4)
		.attr("d", cdf)
		.attr("stroke", "black")
		.attr("stroke-width", 1)
		.attr("fill", "rgb(255, 100, 0)");*/

		

	var xAxis = d3.axisBottom(x);
	svg.append('g')
		.attr('transform', 'translate(0,' + (y(0)+5) +')')
		.call(xAxis);

	svg.append('text')
		.text("share of population")
		.attr('text-anchor', 'end')
		.attr('x', x(1))
		.attr('y', y(0)+38);
	
	var yAxis = d3.axisRight(y);   
	svg.append('g')
		.attr('transform', 'translate(' + (x(1)+5) +')')
		.call(yAxis);

	svg.append('text')
		.text("share of income")
		.attr('transform', 'translate(' + (x(1)+45) +',' + y(1) + ') rotate(-90)')
		.attr('text-anchor', 'end');
	
});

		</script>
	</body>
</html>
